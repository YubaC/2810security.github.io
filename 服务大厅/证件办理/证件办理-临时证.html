<html lang="zh-CN">

<head>
    <link rel="icon" href="https://yubac.github.io/2810security.github.io/images/icon.png" type="image/x-icon">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="../../css/common.css">
    <script src="../../lib/jquery/js/jquery-3.6.3.min.js"></script>
    <script src="../../js/common.js"></script>
    <link href="https://cdn.staticfile.org/twitter-bootstrap/5.1.1/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.staticfile.org/twitter-bootstrap/5.1.1/js/bootstrap.bundle.min.js"></script>

    <title>证件办理-临时证</title>
    <!--l2d调用-->
    <meta charset="UTF-8">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css">

    <!-- 用户分析统计 -->
    <script type="text/javascript"
        src="https://gcore.jsdelivr.net/gh/YubaC/2810security.github.io@latest/js/tongji0.js"></script>
    <script type="text/javascript"
        src="https://gcore.jsdelivr.net/gh/YubaC/2810security.github.io@latest/js/tongji1.js"></script>
    <!-- 鼠标指针 -->
    <script src="https://gcore.jsdelivr.net/gh/YubaC/2810security.github.io@latest/js/mouse.js"></script>
</head>

<body>
    <script type="text/javascript"
        src="https://gcore.jsdelivr.net/gh/YubaC/2810security.github.io@latest/js/assist-entry.js"></script>

    <!--l2d人物动画-->
    <div>
        <script src="https://gcore.jsdelivr.net/gh/YubaC/2810security.github.io@latest/js/autoload.js"></script>
    </div>

    <header id="header"></header>

    <main class="container-fluid mt-4">
        <div class="container">
            <h1 class="title text-center mb-4">证件办理-临时证</h1>
            <h2 class="h6 fw-bold">济南舜耕中学二十八级十班安全局临时执勤许可证(A4版)</h2>
            <p>根据有关规定，当执勤证件出现丢失、损坏、过期等无法使用的情况，但需要使用执勤证件时，持证人有权向有关部门申请签发临时执勤许可证。有关部门应及时处理。
            </p>
            <p>
                注：打印完成后不得对证件进行涂改。否则证件无效。
            </p>
            <form action="" id="user-input" class="needs-validation" novalidate>
                <div class="mb-3 mt-3">
                    <label for="name" class="form-label">请输入姓名:</label>
                    <input type="text" class="form-control" id="name" placeholder="请输入姓名" name="name" required>
                </div>
                <div class="mb-3 mt-3">
                    <label for="sex" class="form-label">请输入性别:</label>
                    <input type="text" class="form-control" id="sex" placeholder="请输入性别" name="sex" required>
                </div>
                <div class="mb-3 mt-3">
                    <label for="number" class="form-label">请输入原证件号码:</label>
                    <input type="text" class="form-control" id="number" placeholder="请输入原证件号码" name="number" required>
                </div>
                <div class="mb-3 mt-3">
                    <label for="number" class="form-label">请输入职务:</label>
                    <input type="text" class="form-control" id="officer" placeholder="请输入职务" name="number" required>
                </div>
                <div class="mb-3 mt-3">
                    <label for="number" class="form-label">请输入申请日期:</label>
                    <input type="text" class="form-control" id="date" placeholder="请输入申请日期" name="number" required>
                </div>
            </form>
            <button id='exportBtn' class="btn btn-primary">生成临时执勤许可证</button>
        </div>

    </main>

    <hr>

    <footer id="footer" class="mt-4 bg-dark"></footer>
</body>

<script src="https://cdn.jsdelivr.net/npm/jspdf/dist/jspdf.umd.js"></script>
<script src="https://gcore.jsdelivr.net/gh/YubaC/2810security.github.io@latest/js/fzxiysjw.js"></script>
<script>
    // 检查输入
    function checkForm() {
        $('#user-input').addClass('was-validated');
        return $('#user-input')[0].checkValidity();
    };

    exportBtn.onclick = function () {
        if (!checkForm()) {
            window.alert('请输入完整的个人信息！');
            return;
        }

        $('#exportBtn').html(`<div class="spinner-border spinner-border-sm me-2" aria-hidden="true"></div>正在生成生成临时执勤许可证...`).attr('disabled', true);

        // v1
        // var doc = new jsPDF();
        // v2
        // var name = prompt('请输入姓名:');
        // var sex = prompt('请输入性别:');
        // var number = prompt('请输入原证件号码:');
        // var officer = prompt('请输入职务:');
        // var date = prompt('请输入申请日期:');

        var name = document.getElementById("name").value;
        var sex = document.getElementById("sex").value;
        var number = document.getElementById("number").value;
        var officer = document.getElementById("officer").value;
        var date = document.getElementById("date").value;
        name = name.toString();
        sex = sex.toString();
        number = number.toString();
        officer = officer.toString();
        date = date.toString();

        var doc = new jspdf.jsPDF('a4', 'mm');

        // 添加并设置字体
        doc.addFont('fzxiysjw.ttf', 'fzxiysjw', 'normal');
        doc.setFont('fzxiysjw');
        doc.setFontSize(12);
        doc.text(25.4 + 25.4 * 0, 297 - 25.4 - 25.4 * 10, '经有关部门登记盖章后有效');
        doc.text(25.4 + 25.4 * 0, 297 - 25.4 - 25.4 * 9.5, '        济南舜耕中学二十八级十班安全局临时执勤许可证(A4版)');
        doc.text(25.4 + 25.4 * 0, 297 - 25.4 - 25.4 * 9, '    根据有关规定，当执勤证件出现丢失、损坏、过期等无法使用的情况，但需要使用');
        doc.text(25.4 + 25.4 * 0, 297 - 25.4 - 25.4 * 8.5, '执勤证件时，持证人有权向有关部门申请签发临时执勤许可证。');
        doc.text(25.4 + 25.4 * 0, 297 - 25.4 - 25.4 * 8, '    有关部门应及时处理。登记处名称：');
        doc.text(25.4 + 25.4 * 0, 297 - 25.4 - 25.4 * 7.5, '姓  名');
        doc.text(25.4 + 25.4 * 1, 297 - 25.4 - 25.4 * 7.5, name);
        doc.text(25.4 + 25.4 * 0, 297 - 25.4 - 25.4 * 7, '性  别');
        doc.text(25.4 + 25.4 * 1, 297 - 25.4 - 25.4 * 7, sex);
        doc.text(25.4 + 25.4 * 0, 297 - 25.4 - 25.4 * 6.5, '原证件号码');
        doc.text(25.4 + 25.4 * 1, 297 - 25.4 - 25.4 * 6.5, number);
        doc.text(25.4 + 25.4 * 0, 297 - 25.4 - 25.4 * 6, '职  务');
        doc.text(25.4 + 25.4 * 1, 297 - 25.4 - 25.4 * 6, officer);
        doc.text(25.4 + 25.4 * 3, 297 - 25.4 - 25.4 * 7.5, '申请日期');
        doc.text(25.4 + 25.4 * 4, 297 - 25.4 - 25.4 * 7.5, date);
        doc.text(25.4 + 25.4 * 3, 297 - 25.4 - 25.4 * 7, '登记日期');
        doc.text(25.4 + 25.4 * 3, 297 - 25.4 - 25.4 * 6.5, '登记号码');
        doc.text(25.4 + 25.4 * 3, 297 - 25.4 - 25.4 * 6, '有效期');
        doc.text(25.4 + 25.4 * 4, 297 - 25.4 - 25.4 * 6, '自登记日期起14日');
        doc.text(25.4 + 25.4 * 5.5, 297 - 25.4 - 25.4 * 7.5, '本人一');
        doc.text(25.4 + 25.4 * 5.5, 297 - 25.4 - 25.4 * 7, '寸近照');
        doc.text(25.4 + 25.4 * 0, 297 - 25.4 - 25.4 * 5.8, '——————————————登记处章骑缝线——————————————裁剪线');
        doc.text(25.4 + 25.4 * 0, 297 - 25.4 - 25.4 * 5.5, '    下联签字盖章后交有关部门保存。登记处名称：');
        doc.text(25.4 + 25.4 * 0, 297 - 25.4 - 25.4 * 5, '姓  名');
        doc.text(25.4 + 25.4 * 1, 297 - 25.4 - 25.4 * 5, name);
        doc.text(25.4 + 25.4 * 0, 297 - 25.4 - 25.4 * 4.5, '性  别');
        doc.text(25.4 + 25.4 * 1, 297 - 25.4 - 25.4 * 4.5, sex);
        doc.text(25.4 + 25.4 * 0, 297 - 25.4 - 25.4 * 4, '原证件号码');
        doc.text(25.4 + 25.4 * 1, 297 - 25.4 - 25.4 * 4, number);
        doc.text(25.4 + 25.4 * 0, 297 - 25.4 - 25.4 * 3.5, '职  务');
        doc.text(25.4 + 25.4 * 1, 297 - 25.4 - 25.4 * 3.5, officer);
        doc.text(25.4 + 25.4 * 3, 297 - 25.4 - 25.4 * 5, '申请日期');
        doc.text(25.4 + 25.4 * 4, 297 - 25.4 - 25.4 * 5, date);
        doc.text(25.4 + 25.4 * 3, 297 - 25.4 - 25.4 * 4.5, '登记日期');
        doc.text(25.4 + 25.4 * 3, 297 - 25.4 - 25.4 * 4, '登记号码');
        doc.text(25.4 + 25.4 * 3, 297 - 25.4 - 25.4 * 3.5, '有效期');
        doc.text(25.4 + 25.4 * 4, 297 - 25.4 - 25.4 * 3.5, '自登记日期起14日');
        doc.text(25.4 + 25.4 * 5.5, 297 - 25.4 - 25.4 * 5, '本人一');
        doc.text(25.4 + 25.4 * 5.5, 297 - 25.4 - 25.4 * 4.5, '寸近照');
        doc.text(25.4 + 25.4 * 0, 297 - 25.4 - 25.4 * 3, '申请人签字：');
        doc.text(25.4 + 25.4 * 0, 297 - 25.4 - 25.4 * 2.5, '登记处意见：');


        doc.save('临时执勤许可证(A4版).pdf');

        $('#exportBtn').html('生成完毕！');
        setTimeout(function () {
            $('#exportBtn').html('生成临时执勤许可证').attr('disabled', false);
        }, 1500);

    }
</script>

</html>